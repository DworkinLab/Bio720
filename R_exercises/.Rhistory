grep("^[0-9]+\.", species_slice$text, value=TRUE)
species_slice$text[1:10]
books[["title"]]
books
books$title[1]
species <- gutenberg_download(22764)
species_text <- species$text
empty <- sum(stri_isempty(species_text))/length(species_text)
empty
length(grep("INTRODUCTION\\.",species_text, ignore.case = F)) # provides the positions in the text
sum(str_detect(species_text, "INTRODUCTION\\.")) #boolean for each word
length(str_subset(species_text, "INTRODUCTION\\.")) # equivalent to the grep statement
species_text[c(49, 68, 281)]  # each word position in the text with INTRODUCTION.
grep("INTRODUCTION\\.",species_text, ignore.case = F)
species_text[c(301)]  # each word position in the text with INTRODUCTION.
species_slice <- species %>%
slice(grep("^INTRODUCTION\\.", text)[1]:(grep("^INDEX\\.", text)) - 1)
grep("^[0-9]+\\.", species_slice$text, value=TRUE)
books$title[1]
books
books %>% select(title)
species <- gutenberg_download(1228)
species_text <- species$text
empty <- sum(stri_isempty(species_text))/length(species_text)
empty
length(grep("INTRODUCTION\\.",species_text, ignore.case = F)) # provides the positions in the text
sum(str_detect(species_text, "INTRODUCTION\\.")) #boolean for each word
length(str_subset(species_text, "INTRODUCTION\\.")) # equivalent to the grep statement
species_text[c(301)]  # each word position in the text with INTRODUCTION.
species_slice <- species %>%
slice(grep("^INTRODUCTION\\.", text)[1]:(grep("^INDEX\\.", text)) - 1)
grep("INTRODUCTION\\.",species_text, ignore.case = F)
species_slice <- species %>%
slice(grep("^INTRODUCTION\\.", text)[1]:(grep("^INDEX\\.", text)) - 1)
head(species_slice)
species_slice <- species %>%
slice(grep("^INTRODUCTION\\.", text)[2]:(grep("^INDEX\\.", text)) - 1)
head(species_slice)
grep("VARIATION UNDER DOMESTICATION", species_slice$text, value=TRUE)
grep("VARIATION UNDER DOMESTICATION", species_slice$text, value=F)
species_slice$text[171:173]
grep("^CHAPTER+\\.", species_slice$text, value=TRUE)
grep("^CHAPTER.", species_slice$text, value=TRUE)
grep("^CHAPTER", species_slice$text, value=TRUE)
length(species_slice$text)
sum(nzchar(species_slice$text))
species_filtered <- species %>%
slice(grep("^INTRODUCTION\\.", text):(grep("^INDEX\\.", text))-1) %>%
filter(nzchar(text)) %>%
mutate(linenumber = row_number(),
chapter = cumsum(grepl("^[0-9]+\\.", text)))
species_filtered
species_filtered$text <- toupper(species_filtered$text)
head(species_filtered$text)
species_tidy <- species_filtered %>%
unnest_tokens(word, text)
species_tidy <- species_tidy %>%
anti_join(stop_words)
word_counts_10 <- species_tidy %>%
count(word, sort = TRUE) %>%
top_n(10) %>%
mutate(word = reorder(word, n))
word_counts_10
library(wordcloud)
install.packages("wordcloud")
library(wordcloud)
species_tidy %>%
count(word, sort = TRUE) %>%
top_n(25) %>%
mutate(word = reorder(word, n)) %>%
with(wordcloud(word, n, random.order = F, max.words  = 25, colors = rainbow(8)))
word_counts_25 <- species_tidy %>%
count(word, sort = TRUE) %>%
top_n(25) %>%
mutate(word = reorder(word, n))
word_counts_25 <- data.frame(word_counts_25)
with(word_counts_25,
wordcloud(word, n, random.order = F, max.words = 25, col = rainbow(n = 5)))
knitr::opts_chunk$set(echo = TRUE)
library(BiocManager)
BiocManager::install(c("MotifDb",
"TxDb.Scerevisiae.UCSC.sacCer3.sgdGene",
"org.Sc.sgd.db", "BSgenome.Scerevisiae.UCSC.sacCer3",
"motifStack", "seqLogo"))
library(MotifDb)
library(S4Vectors)
library(seqLogo)
library(motifStack)
library(Biostrings)
library(GenomicFeatures)
library(org.Sc.sgd.db)
library(BSgenome.Scerevisiae.UCSC.sacCer3)
library(TxDb.Scerevisiae.UCSC.sacCer3.sgdGene)
query(MotifDb, "DAL80")
#query(MotifDb, 'Dmelanogaster')
pfm.dal80.jaspar <- query(MotifDb,"DAL80")[[1]]
class(pfm.dal80.jaspar)
pfm.dal80.jaspar
seqLogo(pfm.dal80.jaspar)
#library(BiocInstaller) # old deprecated
library(BiocManager) # new way
library(Biostrings)
library(GenomicRanges)
library(GenomicFeatures)
library('BSgenome')
#library(BiocInstaller) # old deprecated
library(BiocManager) # new way
library(Biostrings)
BiocManager::install("BSgenome")
BiocManager::install("Biostrings")
BiocManager::install("Biostrings")
library(Biostrings)
BiocManager::install("GenomeInfoDbData")
BiocManager::install("GenomicRanges")
BiocManager::install("GenomicFeatures")
#library(BiocInstaller) # old deprecated
library(BiocManager) # new way
library(Biostrings)
library(GenomicRanges)
library(GenomicFeatures)
library('BSgenome')
available.genomes()
#biocLite("BSgenome.Dmelanogaster.UCSC.dm6")
BiocManager::install("BSgenome.Dmelanogaster.UCSC.dm6")
library(BSgenome.Dmelanogaster.UCSC.dm6)
dm <- BSgenome.Dmelanogaster.UCSC.dm6
length(dm)
names(dm)
show(dm)
organism(dm)
seqinfo(dm)
isS4(dm)
seqlengths(BSgenome.Dmelanogaster.UCSC.dm6)
alphabetFrequency(dm$chr2R,
baseOnly = T, as.prob = T)
seqlengths(BSgenome.Dmelanogaster.UCSC.dm6)
length(dm)
names(dm)
seqinfo(dm)
sum(seqlengths(dm))/1e6
dm_chrX <- getSeq(dm, "chrX")
nchar(dm_chrX)/1e6
alphabetFrequency(dm_chrX, baseOnly = T, as.prob = T)
seqs <- c("CCCGGG", "CCCCTTTT", "AAATTT", "TAGCT")
n = sapply(seqs, function(x) countPattern(x, dm_chrX ))
n
which.max(n)
?countPattern
data(HNF4alpha)
HNF4alpha
class(HNF4alpha)
pfm <- consensusMatrix(HNF4alpha)
round(pfm[1:4,]/colSums(pfm[1:4,]), 2)
class(pfm)
pwm <- PWM(pfm)
# or directly
pwm <- PWM(HNF4alpha, type = "prob")
round(pwm[1:4,]/colSums(pwm[1:4,]), 2)
maxWeights(pwm)
conMat <- consensusMatrix(HNF4alpha, as.prob = T)[1:4,]
seqLogo(conMat)
seqLogo(pwm[1:4,]/colSums(pwm[1:4,]))
TF_hits <- matchPWM(pwm, dm_chrX, with.score = TRUE)
length(TF_hits)
head(mcols(TF_hits)$score)
hist(mcols(TF_hits)$score)
TF_hits_rc <- matchPWM(reverseComplement(pwm), dm_chrX, with.score = TRUE)
length(TF_hits_rc)
hist(mcols(TF_hits_rc)$score)
dm_txdb <- makeTxDbFromUCSC("dm6", tablename="refGene")
BiocManager::install("RMariaDB")
dm_txdb <- makeTxDbFromUCSC("dm6", tablename="refGene")
up10000seqs <- extractUpstreamSeqs(dm, dm_txdb, width=10000)
up10000seqs <- extractUpstreamSeqs(dm, dm_txdb, width=10000)
upstream_hits <- vcountPattern("NGNNCAAAGNNCA", up10000seqs)
length(upstream_hits)
fly_seq <- c(A = "ACTGGCCA", B = "ACTGGCCT", C = "ACTGTCCA" )
print(fly_seq)
writeLines(fly_seq)
fly_seq <- c(A = "ACTGGCCA", B = "ACTGGCCT", C = "ACTGTCCA" )
print(fly_seq)
writeLines(fly_seq)
writeLines(fly_seq, sep ="\n")
cat(fly_seq, sep ="\n")
print(fly_seq)
writeLines(fly_seq)
writeLines(fly_seq, sep ="\n")
cat(fly_seq, sep ="\n")
?print
?writeLines
writeLines(fly_seq, sep = NULL)
writeLines(fly_seq, sep = F)
writeLines(fly_seq, sep = " ")
writeLines(fly_seq, sep = " ")
writeLines(fly_seq, sep = " ")
writeLines(fly_seq, sep ="\n")
cat(fly_seq, sep ="\n")
cat(fly_seq)
print(fly_seq)
paste("x", 1:5, sep="", collapse = " + ")
seq_gen <- function() {
x <- sample(c("A", "C", "T", "G"),
size = rbinom(100, 100, 0.8),
replace =T)
paste0(x, collapse="")
}
seqs <- replicate(20, seq_gen())
seqs
?sample
length(seqs)
nchar(seqs)
str_length(seqs)
stri_length(seqs)
length(seqs)
file_labels <- c("ID_GeneKnockdown2018_ds-RNAi_M_1_1",
"ID_GeneKnockdown2018_ds-RNAi_F_1_1",
"ID_GeneKnockdown2018_control_M_1_1",
"ID_GeneKnockdown2018_control_F_1_1")
str_split(file_labels, pattern = "_")
```{r}
str_split(file_labels, pattern = "_", simplify = T)
covariates_mat <- str_split(file_labels, pattern = "_", simplify = T)
colnames(covariates_mat) <- c("lab_peep", "experiment", "treatment", "sex", "vial", "individual")
covariates_mat
library(devtools)
library(gutenbergr)
library(tidyverse)
books <- gutenberg_works(grepl(title,
pattern = "On the origin of species",
ignore.case = TRUE))
books
books[["title"]]
books %>% select(title)
library(dplyr)
books %>% select(title)
books$title[1]
species <- gutenberg_download(1228)
str(species)
head(species$text)
species_text <- species$text
library(stringi)
q()
library(stringi)
?stri_isempty
library(stringr)
library(stringi)
library(tidytext)
library(gutenbergr)
library(tidyverse)
books <- gutenberg_works(grepl(title,
pattern = "On the origin of species",
ignore.case = TRUE))
books <- gutenberg_works(str_detect(title,
regex("on the origin of species",
ignore_case = TRUE)))
books
species <- gutenberg_download(1228)
str(species)
head(species$text)
species_text <- species$text
stri_isempty(species_text)
sum(stri_isempty(species_text))
length(species_text)
empty <- sum(stri_isempty(species_text))/length(species_text)
empty
length(grep("INTRODUCTION\\.",species_text, ignore.case = F)) # provides the positions in the text
grep("INTRODUCTION\\.",species_text, ignore.case = F)
sum(str_detect(species_text, "INTRODUCTION\\.")) #boolean for each word
length(str_subset(species_text, "INTRODUCTION\\.")) # equivalent to the grep statement
str_detect(species_text, "INTRODUCTION\\.")
species_text[c(49, 68, 281)]  # each word position in the text with INTRODUCTION.
species_slice <- species %>%
slice(grep("^INTRODUCTION\\.", text)[2]:(grep("^INDEX\\.", text)) - 1)
species_slice
?grep
grep("^CHAPTER", species_slice$text, value=TRUE)
grep("^CHAPTER", species_slice$text, value=FALSe)
grep("^CHAPTER", species_slice$text, value=FALSE)
length(grep("^CHAPTER", species_slice$text, value=TRUE))
nzchar(species_slice$text)
sum(nzchar(species_slice$text))
length(species_slice$text)
?nzchar
species_filtered <- species %>%
slice(grep("^INTRODUCTION\\.", text):(grep("^INDEX\\.", text))-1) %>%
filter(nzchar(text)) %>%
mutate(linenumber = row_number(),
chapter = cumsum(grepl("^[0-9]+\\.", text)))
head(species_filtered )
sum(nzchar(species_slice$text))
species_filtered$text <- toupper(species_filtered$text)
head(species_filtered$text)
head(species_filtered )
species_tidy <- species_filtered %>%
unnest_tokens(word, text)
head(species_tidy)
species_tidy <- species_tidy %>%
anti_join(stop_words)
head(species_tidy)
word_counts_10 <- species_tidy %>%
count(word, sort = TRUE) %>%
top_n(10) %>%
mutate(word = reorder(word, n))
word_counts_10
library(wordcloud)
species_tidy %>%
count(word, sort = TRUE) %>%
top_n(25) %>%
mutate(word = reorder(word, n)) %>%
with(wordcloud(word, n, random.order = F, max.words  = 25, colors = rainbow(8)))
word_counts_25 <- species_tidy %>%
count(word, sort = TRUE) %>%
top_n(25) %>%
mutate(word = reorder(word, n))
word_counts_25 <- data.frame(word_counts_25)
with(word_counts_25,
wordcloud(word, n, random.order = F, max.words = 25, col = rainbow(n = 5)))
#library(BiocInstaller) # old deprecated
library(BiocManager) # new way
library(Biostrings)
library(GenomicRanges)
library(GenomicFeatures)
library('BSgenome')
library(seqLogo)
library(BSgenome.Dmelanogaster.UCSC.dm6)
Dm6 <- BSgenome.Dmelanogaster.UCSC.dm6
head(sort(seqlengths(Dm6), decreasing  = TRUE))
seqinfo(Dm6)
sum(seqlengths(Dm6)[1:8])
sum(seqlengths(Dm6)[1:8])/1e6  # Mbp
alphabetFrequency(Dm6$chr2R)
alphabetFrequency(Dm6$chr2R,
baseOnly = T, as.prob = T)
dm_chrX <- getSeq(Dm6, names = "chrX")
dm_chrX
show(dm_chrX)
print(dm_chrX)
class(dm_chrX) # This is now a DNAString type object, not a BSgenome object
typeof(dm_chrX)
length(dm_chrX)/1e6  # hey, why does this work!?   ;)
nchar(dm_chrX)/1e6
alphabetFrequency(dm_chrX, baseOnly = T, as.prob = T)
dm_chr3L <- getSeq(Dm6, names = "chr3L",
start = 1000000,
end = 2000000,
strand = "-")
alphabetFrequency(dm_chr3L, baseOnly = T, as.prob = T)
seqs2 <- c("CCCNGG", "CCCNTTTT", "AAANTT", "TAGNT")
n = sapply(seqs2, function(x) countPattern(x, dm_chrX, fixed = FALSE ))
n
which.max(n)
data(HNF4alpha)
HNF4alpha
class(HNF4alpha)
pfm <- consensusMatrix(HNF4alpha)
pfm
round(pfm[1:4,]/colSums(pfm[1:4,]), 2)
class(pfm)
pwm <- PWM(HNF4alpha, type = "prob")
round(pwm[1:4,]/colSums(pwm[1:4,]), 2)
maxWeights(pwm)
conMat <- consensusMatrix(HNF4alpha, as.prob = T)[1:4,]
seqLogo(conMat)
seqLogo(pwm[1:4,]/colSums(pwm[1:4,]))
pwm
?matchPWM
dm_txdb <- makeTxDbFromUCSC("dm6", tablename="refGene")
dm_txdb
head(transcripts(dm_txdb))  # let's look at the transcripts we have
head(up10000seqs)
up10000seqs <- extractUpstreamSeqs(Dm6, dm_txdb, width=10000)
head(up10000seqs)
?vcountPatter
?vcountPattern
upstream_hits <- vcountPattern("NGNNCAAAGNNCA", up10000seqs, fixed = FALSE)
length(upstream_hits)
upstream_hits
?maskMotif
TF_hits_blah <- matchPWM(pwm, up10000seqs, with.score = TRUE)
matchPWM()
?matchPWM
q()
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
options(digits  = 3)
dll_data = read.csv("http://datadryad.org/bitstream/handle/10255/dryad.8377/dll.csv", header=TRUE)
dll_data = read.csv("http://beaconcourse.pbworks.com/f/dll.csv",
h = T, stringsAsFactors = TRUE)
anyDuplicated(dll_data)
mean(dll_data$femur)
mean(dll_data$femur, na.rm = TRUE)
dll_data <- na.omit(dll_data)
mean(dll_data$femur)
anyDuplicated(dll_data)
new_rows <- dll_data[sample(nrow(dll_data), size = 5, replace = T ),]
dll_data2 <- rbind(dll_data, new_rows)
str(dll_data2)
dll_data_unique <- unique(dll_data2)
dim(dll_data_unique)
dim(dll_data2)
dim(dll_data)
rm(dll_data_complete, dll_data_unique, dll_data2)
str(dll_data)
summary(dll_data)
str(dll_data)
dim(dll_data)
head(dll_data)
head(is.na(dll_data))
sum(is.na(dll_data))
mean(dll_data$femur)
mean(dll_data$femur, na.rm = TRUE)
dll_data_complete <- na.omit(dll_data)
dim(dll_data)
dim(dll_data_complete)
dll_data <- na.omit(dll_data)
mean(dll_data$femur)
head(duplicated(dll_data))
tail(duplicated(dll_data))
sum(duplicated(dll_data))
any(duplicated(dll_data))
anyDuplicated(dll_data)
dll_data[anyDuplicated(dll_data),]
new_rows <- dll_data[sample(nrow(dll_data), size = 5, replace = T ),]
dll_data2 <- rbind(dll_data, new_rows)
str(dll_data2)
any(duplicated(dll_data2))
dll_data2[duplicated(dll_data2),]
dll_data_unique <- unique(dll_data2)
dim(dll_data_unique)
dim(dll_data2)
dim(dll_data)
rm(dll_data_complete, dll_data_unique, dll_data2)
dll_data_wt <- dll_data[dll_data$genotype == "wt",]
with(dll_data, table(genotype))
nrow(dll_data_wt)
levels(dll_data_wt$genotype)
dll_data_wt <- droplevels(dll_data_wt)
levels(dll_data_wt$genotype)
dll_data_Dll <- subset(dll_data, genotype == "Dll" )
dim(dll_data_Dll)
with(dll_data, table(genotype))
levels(dll_data_Dll$genotype)
dll_data_Dll <- droplevels(dll_data_Dll)
dll_data_Dll <- subset(dll_data,
genotype == "Dll",
select = c(line, genotype, temp, SCT))
dim(dll_data_Dll)
matched_set <- dll_data$line %in% c("line-Sam", "line-1")
sum(matched_set)
dll_data_new_subset <- dll_data[matched_set,]
dim(dll_data_new_subset)
rm(dll_data_Dll, dll_data_wt, dll_data_new_subset, matched_set)
levels(dll_data$line)
line_str <- as.character(dll_data$line)
str(line_str)
head(line_str)
line_names <- substr(line_str,
start = 6, stop= 1000000L )
head(line_names)
tail(line_names)
line_names2 <- strsplit(line_str, split = "-")
head(line_names2)
?strsplit
str(line_str)
line_names3 <- gsub(pattern = "line-",
replacement = "",
x = line_str)
head(line_names3)
tail(line_names3)
line_names3 <- tolower(line_names3)
head(line_names3)
tail(line_names3, n = 25)
line_names3 <- sub("sam", "SAMARKAND", line_names3)
str(dll_data$temp)
temp_as_factor <- with(dll_data,
factor(temp,
labels = c("LowTemp", "HighTemp")))
str(temp_as_factor)
head(temp_as_factor)
tail(temp_as_factor)
temp_as_factor2 <- with(dll_data, ifelse(temp == 25, "LowTemp",
ifelse(temp == 30, "HighTemp", NA)))
temp_as_factor2 <- factor(temp_as_factor2)
str(temp_as_factor2)
head(sort(dll_data$SCT))
tail(sort(dll_data$SCT))
dll_data_sorted <- dll_data[order(dll_data$SCT),]
head(dll_data_sorted)
dll_data_sorted <- dll_data[order(-dll_data$SCT),]
head(dll_data_sorted)
dll_data_sorted <- dll_data[order(dll_data$SCT, dll_data$temp),]
head(dll_data_sorted)
head(dll_data)
line_names <- dll_data$line
levels(line_names)
elevations <- c(100, 300, 270, 250, 500, 900, 500, 1100, 500,
3000,500, 570, 150, 800, 600, 500, 1900, 100,
300, 270, 250, 500, 900, 500, 1100, 500, 600)
MeanDayTimeTemp <- c(rnorm(27, mean = 20, sd = 5))
elevation_data <- data.frame(levels(line_names),
elevations,
MeanDayTimeTemp)
names(dll_data)
names(elevation_data)
names(elevation_data)[1] <- "line"
str(elevation_data)
merged_data <- merge(x = elevation_data,
y = dll_data)
merged_data <- merge(x = elevation_data,
y = dll_data,
sort = FALSE)
head(merged_data)
tail(merged_data)
