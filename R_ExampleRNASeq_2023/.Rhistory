install.packages("ComplexHeatmap")
install.packages("RNAseqQC", dependencies = FALSE)
library("RNAseqQC")
BiocManager::install("ComplexHeatmap")
install.packages("RNAseqQC")
# Load in data
sample_info <- read.csv("./plot_sample_info.csv")
salmon_counts <- read.csv("./salmon_counts_raw_all.csv", row.names = 1)
salmon_counts <- read.csv("./salmon_counts_raw_all.csv", row.names = 1)
# remove the outlier to match the counts data
sample_info <- sample_info[-5,]
salmon_counts <- round(salmon_counts)
# make it so that they match explicitly
rownames(sample_info) <- colnames(salmon_counts)
dds <- DESeqDataSetFromMatrix(countData = salmon_counts,
colData = sample_info,
design = ~ background + perturbation)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = salmon_counts,
colData = sample_info,
design = ~ background + perturbation)
dds
# filter low count genes
dds <- filter_genes(dds, min_count = 5)
library(tximport)
# filter low count genes
dds <- filter_genes(dds, min_count = 5)
library("RNAseqQC")
# filter low count genes
dds <- filter_genes(dds, min_count = 5)
# variance stabilizing
vsd <- vst(dds)
# check if it worked! Think so
mean_sd_plot(vsd)
options(ggplot2.continuous.colour = "viridis")
plot_pca(vsd, PC_x = 1, PC_y = 5,
color_by = "perturbation",
shape_by = "background",
point_alpha = 1, point_rel_size = 4)
# Plot scatter plot comparing PC1 through PC5
plot_pca_scatters(vsd, n_PCs = 5,
color_by = "perturbation",
shape_by = "background",
point_alpha = 1, show_var_exp = FALSE)
pca_df <- data.frame(PC = 1:10,
'Variance explained' = pca_Res$var_exp[1:10])
rownames(sample_info)
sample_info
# plot individual PC plots
plot_pca(vsd, PC_x = 1, PC_y = 5,
color_by = "perturbation",
shape_by = "background",
point_alpha = 1, point_rel_size = 4)
# plot individual PC plots
plot_pca(vsd, PC_x = 1, PC_y = 2,
color_by = "perturbation",
shape_by = "background",
point_alpha = 1, point_rel_size = 4)
str(vsd)
?vst
# filter low count genes
dds <- filter_genes(salmon_counts, min_count = 5)
# variance stabilizing
vsd <- vst(salmon_counts)
class(salmon_counts)
View(salmon_counts)
salmon_counts_mat <- as.matrix(salmon_counts)
# filter low count genes
dds <- filter_genes(salmon_counts_mat, min_count = 5)
# variance stabilizing
vsd <- vst(salmon_counts_mat)
# check if it worked! Think so
mean_sd_plot(vsd)
View(vsd)
unlink("~/Dropbox/macBook_HD/TeachingAndLectures/Bio720/Bio720/lectures/WelcomeBIO720_cache", recursive = TRUE)
?format
library("RNAseqQC")
library("DESeq2")
library("ensembldb")
library("dplyr")
library("ggplot2")
library("purrr")
library("tidyr")
library("tibble")
library("magrittr")
# Load in data
sample_info <- read.csv("./plot_sample_info.csv")
View(sample_info)
# remove the outlier to match the counts data
sample_info <- sample_info[-5,]
salmon_counts <- read.csv("./salmon_counts_raw_all.csv",
row.names = 1)
salmon_counts <- round(salmon_counts)
# make it so that they match explicitly
rownames(sample_info) <- colnames(salmon_counts)
dds <- DESeqDataSetFromMatrix(countData = salmon_counts,
colData = sample_info,
design = ~ background + perturbation)
# filter low count genes
dds <- filter_genes(dds, min_count = 5)
# variance stabilizing
vsd <- vst(dds)
options(ggplot2.continuous.colour = "viridis")
plot_pca(vsd, PC_x = 1, PC_y = 2,
color_by = "perturbation",
shape_by = "background",
point_alpha = 1, point_rel_size = 4)
q()
